function GeneraExcel(NombreReporte,IdTabla){showLoading();const fecha=new Date;NombreReporte="Rpt_"+NombreReporte.replace("Rpt_","").replace("Rpt",""),exportTableToExcel(IdTabla,(NombreReporte+="_"+fecha.getFullYear().toString()+("0"+(fecha.getMonth()+1).toString()).slice(-2)+("0"+fecha.getDate().toString()).slice(-2)+("0"+fecha.getHours().toString()).slice(-2)+fecha.getMinutes().toString()).replace(" ","")),hideLoading()}function GenerarExcel(NombreReporte,IdCmbEstatus,IdTabla){showLoading();const fecha=new Date;NombreReporte="Rpt_"+NombreReporte;var CmbEstatus=document.getElementById(IdCmbEstatus);""!=CmbEstatus.value&&(NombreReporte=NombreReporte.replace("General",""),NombreReporte+=CmbEstatus.options[CmbEstatus.selectedIndex].text),exportTableToExcel_special(IdTabla,(NombreReporte+="_"+fecha.getFullYear().toString()+("0"+(fecha.getMonth()+1).toString()).slice(-2)+("0"+fecha.getDate().toString()).slice(-2)+("0"+fecha.getHours().toString()).slice(-2)).replace(" ","")),hideLoading()}function exportTableToExcel(tableID,filename){var tableHTML,headerHTML,tableSelect,downloadLink,dataType="application/vnd.ms-excel";if(showLoading(),headerHTML="<meta http-equiv='Content-Type' content='text/html;' charset='utf-8' /> ",tableHTML=(headerHTML+="\n <style> td{border:thin solid;vertical-align:middle;} </style> \n")+(tableHTML=(tableHTML=(tableHTML=(tableSelect=document.getElementById(tableID)).outerHTML).replace(/<th>/g,"<th >")).replace(/<th /g,"<th style='background:#223f94;color:#FFF;' ")),filename=filename?filename+".xls":"excel_data.xls",downloadLink=document.createElement("a"),document.body.appendChild(downloadLink),navigator.msSaveOrOpenBlob){var blob=new Blob(["ufeff",tableHTML],{type:dataType});navigator.msSaveOrOpenBlob(blob,filename)}else downloadLink.href="data:"+dataType+", "+encodeURIComponent(tableHTML),downloadLink.download=filename,downloadLink.click();document.body.removeChild(downloadLink),hideLoading()}function exportTableToExcel_special(tableID,filename=""){var objById,objHTML,tableHTML,tableSelect,downloadLink,dataType="application/vnd.ms-excel",arrColumnsToDelete=document.getElementsByClassName("delC"),arrElementsToDelete=["select_activos","hdnEtape_4","table-buscar","select_activos"],arrHeadersToChange=["thNo","thName","thArea","thPrio","thType","thCus","thFre","tdDS","tdDM","tdDSe","tdH","tdM","tdUC","tdFC","tdUM","tdFM","tdP1","tdP2","tdP3","tdP4","thCmd"],colObjHTML;for(var i in showLoading(),tableHTML=(tableSelect=document.getElementById(tableID)).outerHTML,arrHeadersToChange)null!=(objById=document.getElementById(arrHeadersToChange[i]))&&(objHTML=document.getElementById(arrHeadersToChange[i]).outerHTML,tableHTML=tableHTML.replace(objHTML,objHTML.replace('rowspan="2"','rowspan="1"'))),objById=null;for(var i in arrColumnsToDelete)objHTML=arrColumnsToDelete[i].outerHTML,tableHTML=tableHTML.replace(objHTML,"");for(var i in arrElementsToDelete)null!=(objById=document.getElementById(arrElementsToDelete[i]))&&(objHTML=document.getElementById(arrElementsToDelete[i]).outerHTML,tableHTML=tableHTML.replace(objHTML,"")),objById=null;var s=0,newObjHTML;tableHTML="<style>.delC{display:none;visibility:collapse;} td{border:thin solid;} .trHeader{background-color:#223F94;font-family:'Roboto',sans-serif;color:#FFFFFF;}<style> "+(tableHTML="<meta http-equiv='Content-Type' content='text/html;' charset='utf-8' /> "+tableHTML);var arrId=["thNo","tdDS","tdDM","tdDSe","tdUC","tdFC","tdUM","tdFM"],arrAnt=["N°","Días","Días","Días","creación","creación","modificación","modificación"],arrNew=["No.","Dias","Dias","Dias","creacion","creacion","modificacion","modificacion"];for(var j in arrId)null!=(objById=document.getElementById(arrId[j]))&&(objHTML=document.getElementById(arrId[j]).outerHTML,newObjHTML=(newObjHTML=document.getElementById(arrId[j]).outerHTML.replace(arrAnt[j],arrNew[j])).replace(arrAnt[j],arrNew[j]),tableHTML=tableHTML.replace(objHTML,newObjHTML)),objById=null;var arrTR=document.getElementsByTagName("tr");for(var k in arrTR)try{void 0!==arrTR[k]&&null!=arrTR[k]&&"none"==arrTR[k].style.display&&(objHTML=arrTR[k].outerHTML,tableHTML=tableHTML.replace(objHTML,""))}catch{}if(objHTML=null,newObjHTML=null,filename=filename?filename+".xls":"excel_data.xls",downloadLink=document.createElement("a"),document.body.appendChild(downloadLink),navigator.msSaveOrOpenBlob){var blob=new Blob(["ufeff",tableHTML],{type:dataType});navigator.msSaveOrOpenBlob(blob,filename)}else downloadLink.href="data:"+dataType+", "+encodeURIComponent(tableHTML),downloadLink.download=filename,downloadLink.click();document.body.removeChild(downloadLink),hideLoading()}function showLoading(){var dvloading=null;null!=(dvloading=document.getElementById("dvloading"))&&(dvloading.style.display="",dvloading.style.visibility="visible")}function hideLoading(){var dvloading=null;null!=(dvloading=document.getElementById("dvloading"))&&(dvloading.style.display="none",dvloading.style.visibility="collapse")}window.showModalDialog=function(url,arg,feature){for(var opFeature=feature.split(","),featuresArray=new Array,i=0;i<opFeature.length-1;i++){var f=opFeature[i].split("=");featuresArray[f[0].toString().trim().toLowerCase()]=f[1].toString().trim()}var h="200px",w="400px",l="100px",t="100px",r="yes",c="yes",s="no",tlbr="no",loc="no",d="no",scro="yes",his="no";featuresArray.toolbar&&(tlbr=featuresArray.toolbar),featuresArray.location&&(loc=featuresArray.location),featuresArray.directories&&(d=featuresArray.directories),featuresArray.scrollbars&&(scro=featuresArray.scrollbars),featuresArray.copyhistory&&(his=featuresArray.copyhistory),featuresArray.height&&(h=featuresArray.height),featuresArray.width&&(w=featuresArray.width),featuresArray.left&&(l=featuresArray.left),featuresArray.top&&(t=featuresArray.top),featuresArray.resizable&&(r=featuresArray.resizable),featuresArray.center&&(c=featuresArray.center),featuresArray.status&&(s=featuresArray.status);var modelFeature="height = "+h+",width = "+w+",left="+l+",top="+t+",model=yes,alwaysRaised=yes,resizable= "+r+",center="+c+",status="+s+",toolbar="+tlbr+",location="+loc+",directories="+d+",scrollbars="+scro+",copyhistory="+his,model;window.open(url,"",modelFeature,null).dialogArguments=arg};